fileVersion: 1
id: ac86f35f-2fe6-42c7-ac4d-1a8080871979
name: STG_ORDERS
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: SILVER
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c7ff433b-e890-42f2-ae76-8a52d0b2250e
          stepCounter: ac86f35f-2fe6-42c7-ac4d-1a8080871979
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: ORDER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0e7b0904-d4a1-489d-b1ef-d6fb3d6c8be2
                stepCounter: 10038635-3871-4e3a-bf66-8988956cd761
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8fd1bb95-5296-4a23-9545-f6f078dae2c5
          stepCounter: ac86f35f-2fe6-42c7-ac4d-1a8080871979
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: TRUCK_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4a421566-703a-4d67-96ed-74e6c63e168e
                stepCounter: 10038635-3871-4e3a-bf66-8988956cd761
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2762f391-d5ba-48e5-8863-a1696074f5fa
          stepCounter: ac86f35f-2fe6-42c7-ac4d-1a8080871979
        config: {}
        dataType: FLOAT
        description: ""
        name: LOCATION_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ac984de1-dbce-42fa-9f93-f1f586a00cdb
                stepCounter: 10038635-3871-4e3a-bf66-8988956cd761
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 32ce5aaa-f0b2-41ae-b706-5db6023df379
          stepCounter: ac86f35f-2fe6-42c7-ac4d-1a8080871979
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: CUSTOMER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 854d23ea-7709-4abe-aa13-f85023ce552e
                stepCounter: 10038635-3871-4e3a-bf66-8988956cd761
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 07cf83fd-ac0e-42fb-bcdf-7a86768aa57e
          stepCounter: ac86f35f-2fe6-42c7-ac4d-1a8080871979
        config: {}
        dataType: VARCHAR(16777216)
        description: ""
        name: DISCOUNT_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 27075250-91bc-4d0a-83de-3e3c44bf9279
                stepCounter: 10038635-3871-4e3a-bf66-8988956cd761
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bda3c5df-8a08-43e2-9cc6-ad9c5f7d870d
          stepCounter: ac86f35f-2fe6-42c7-ac4d-1a8080871979
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: SHIFT_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6620c21d-2877-44f7-9db3-26b32ac33f39
                stepCounter: 10038635-3871-4e3a-bf66-8988956cd761
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e7fac722-726d-4282-8151-04b1d29cdc73
          stepCounter: ac86f35f-2fe6-42c7-ac4d-1a8080871979
        config: {}
        dataType: TIME(9)
        description: ""
        name: SHIFT_START_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 23d8ab86-4331-44d5-b64a-8fc803e22f79
                stepCounter: 10038635-3871-4e3a-bf66-8988956cd761
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4002de61-dd27-4284-85da-b59972b11ef6
          stepCounter: ac86f35f-2fe6-42c7-ac4d-1a8080871979
        config: {}
        dataType: TIME(9)
        description: ""
        name: SHIFT_END_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eefa4375-4b5d-4eac-8835-5cfb734c9e5b
                stepCounter: 10038635-3871-4e3a-bf66-8988956cd761
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d03007c0-3290-4770-9d7b-2d2f3ec5555b
          stepCounter: ac86f35f-2fe6-42c7-ac4d-1a8080871979
        config: {}
        dataType: VARCHAR(16777216)
        description: ""
        name: ORDER_CHANNEL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7ef0448c-6736-4832-a6ab-ec79342450c8
                stepCounter: 10038635-3871-4e3a-bf66-8988956cd761
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ec7bcb0b-21ea-4606-896f-188644129bbf
          stepCounter: ac86f35f-2fe6-42c7-ac4d-1a8080871979
        config: {}
        dataType: TIMESTAMP_NTZ(9)
        description: ""
        name: ORDER_TS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 90dc4470-e33e-4093-8445-d4d6cb82816c
                stepCounter: 10038635-3871-4e3a-bf66-8988956cd761
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5bd7d74b-0058-4f7f-88f1-56003814e378
          stepCounter: ac86f35f-2fe6-42c7-ac4d-1a8080871979
        config: {}
        dataType: VARCHAR(16777216)
        description: ""
        name: SERVED_TS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d0566b92-f161-413d-8d27-936076403b7d
                stepCounter: 10038635-3871-4e3a-bf66-8988956cd761
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bce95bb5-6e17-426e-90c2-d973a2373af0
          stepCounter: ac86f35f-2fe6-42c7-ac4d-1a8080871979
        config: {}
        dataType: VARCHAR(3)
        description: ""
        name: ORDER_CURRENCY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fecea7a0-af9b-4dfb-979e-c19278942621
                stepCounter: 10038635-3871-4e3a-bf66-8988956cd761
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b94abcad-249b-4f95-91cd-319ba90a4822
          stepCounter: ac86f35f-2fe6-42c7-ac4d-1a8080871979
        config: {}
        dataType: NUMBER(38,4)
        description: ""
        name: ORDER_AMOUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8782fc1f-000c-43b0-be02-2d1ecede1592
                stepCounter: 10038635-3871-4e3a-bf66-8988956cd761
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 09605f8f-60b8-4ce4-a065-81c31953030d
          stepCounter: ac86f35f-2fe6-42c7-ac4d-1a8080871979
        config: {}
        dataType: VARCHAR(16777216)
        description: ""
        name: ORDER_TAX_AMOUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 01f3e23a-d509-41e8-92c0-fb56fc35e40d
                stepCounter: 10038635-3871-4e3a-bf66-8988956cd761
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e3bfc9cf-7337-4066-95a2-98c71d598368
          stepCounter: ac86f35f-2fe6-42c7-ac4d-1a8080871979
        config: {}
        dataType: VARCHAR(16777216)
        description: ""
        name: ORDER_DISCOUNT_AMOUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2f89dc54-71d6-4a1e-ba11-d0de65f05d65
                stepCounter: 10038635-3871-4e3a-bf66-8988956cd761
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 96a46745-0a5b-4b0a-aa94-3291d894ea28
          stepCounter: ac86f35f-2fe6-42c7-ac4d-1a8080871979
        config: {}
        dataType: NUMBER(38,4)
        description: ""
        name: ORDER_TOTAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fb7739fc-3952-477c-998b-0cd57c284d42
                stepCounter: 10038635-3871-4e3a-bf66-8988956cd761
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0e3a3fcc-eded-457c-912b-135430496360
          stepCounter: ac86f35f-2fe6-42c7-ac4d-1a8080871979
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: ORDER_DETAIL_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0ad7cd7a-ea6b-469c-b286-163ee5223e04
                stepCounter: ef84ab39-edd8-4745-90e1-97848f42591c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3941efdf-e30d-4309-b75c-1d8a8c21a6a4
          stepCounter: ac86f35f-2fe6-42c7-ac4d-1a8080871979
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: MENU_ITEM_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c7d512e2-7ece-4432-84ec-67f5f962cfc8
                stepCounter: ef84ab39-edd8-4745-90e1-97848f42591c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0bda8221-b188-438d-b471-79d653bdc851
          stepCounter: ac86f35f-2fe6-42c7-ac4d-1a8080871979
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: LINE_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d72334a8-55c9-4378-b442-e142e5453039
                stepCounter: ef84ab39-edd8-4745-90e1-97848f42591c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 77a2825f-83f2-4078-b149-c0bae3651c77
          stepCounter: ac86f35f-2fe6-42c7-ac4d-1a8080871979
        config: {}
        dataType: NUMBER(5,0)
        description: ""
        name: QUANTITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d83db175-b71b-4db6-8e6c-3a2c704d0c62
                stepCounter: ef84ab39-edd8-4745-90e1-97848f42591c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ab53267a-d885-4495-a3b9-8cb18422922e
          stepCounter: ac86f35f-2fe6-42c7-ac4d-1a8080871979
        config: {}
        dataType: NUMBER(38,4)
        description: ""
        name: UNIT_PRICE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d6fbb3a7-8167-474d-9519-4a65f9284aaa
                stepCounter: ef84ab39-edd8-4745-90e1-97848f42591c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b3903b93-2af9-4c8b-9f6a-7d9f2d5da77b
          stepCounter: ac86f35f-2fe6-42c7-ac4d-1a8080871979
        config: {}
        dataType: NUMBER(38,4)
        description: ""
        name: PRICE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0b06d61e-2c20-479f-b83b-b4115cc92f22
                stepCounter: ef84ab39-edd8-4745-90e1-97848f42591c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: db65a88f-0751-4e7e-8e3d-9c148bfda778
          stepCounter: ac86f35f-2fe6-42c7-ac4d-1a8080871979
        config: {}
        dataType: VARCHAR(16777216)
        description: ""
        name: ORDER_ITEM_DISCOUNT_AMOUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 40ba8c5f-2c35-45c0-b37d-4e83c2ed93fd
                stepCounter: ef84ab39-edd8-4745-90e1-97848f42591c
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 032cc925-3a30-4b75-8f90-31a5b9e8b828
          stepCounter: ac86f35f-2fe6-42c7-ac4d-1a8080871979
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: LARGE_ORDER_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: CASE WHEN "ORDER_HEADER_14M"."ORDER_TOTAL" >100 then 'Large Order' else 'Regular Order' END
        systemColumnType: None
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          ORDER_DETAIL_38M: ef84ab39-edd8-4745-90e1-97848f42591c
          ORDER_HEADER_14M: 10038635-3871-4e3a-bf66-8988956cd761
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: RAW
            nodeName: ORDER_DETAIL_38M
          - locationName: RAW
            nodeName: ORDER_HEADER_14M
        join:
          joinCondition: |-
            FROM {{ ref('RAW', 'ORDER_HEADER_14M') }} "ORDER_HEADER_14M"
            INNER JOIN {{ ref('RAW', 'ORDER_DETAIL_38M') }} "ORDER_DETAIL_38M"
            ON "ORDER_HEADER_14M"."ORDER_ID" = "ORDER_DETAIL_38M"."ORDER_ID"
        name: STG_ORDERS
        noLinkRefs: []
  name: STG_ORDERS
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
